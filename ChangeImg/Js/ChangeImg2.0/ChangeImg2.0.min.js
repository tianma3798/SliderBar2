(function(){var ChangeImg=function(elem,opts){this.elem=elem;var defaults={width:1004,height:285,showWidth:817,showHeight:285,hideWidth:175,hideHeight:60,borderWidth:4,borderColor:"#1283D3",linkTarget:"_blank",data:[],changeTime:400,auto:true,autoTime:3000,onChange:function(){}};this.opts=$.extend({},defaults,opts)};var timer=null;ChangeImg.prototype={init:function(){var _this=this;var _elem=this.elem;var _opts=this.opts;_this.initData();_this.initDom();_this.initEvent();if(_opts.auto){_this.startTimer()}},initData:function(){var _this=this;var _elem=this.elem;var _opts=this.opts;var data=_opts.data;_elem.children().each(function(){var thisItem=$(this);var dataItem=thisItem.attr("data-options");dataItem=eval("("+dataItem+")");data.push(dataItem)});_elem.empty()},initDom:function(){var _this=this;var _elem=this.elem;var _opts=this.opts;var data=_this.getData();var changeRight=getDiv("changeRight");changeRight.css({width:_opts.hideWidth});for(var i=0;i<data.length;i++){var item=data[i];var changeItem=getDiv("changeItem");changeItem.append(getDiv("changeBack").append(getImg(item.imgurl,item.title)));changeItem.css({width:_opts.hideWidth,height:_opts.hideHeight});changeItem.attr("data-options",$.toJSON(item));changeItem.appendTo(changeRight)}var changeLeft=getDiv("changeLeft");for(var i=0;i<data.length;i++){var item=data[i];var leftItem=getDiv("leftItem");var aLink=$("<a />");aLink.attr("href",item.link).attr("target",_opts.linkTarget);aLink.append(getImg(item.imgurl,item.title));aLink.appendTo(leftItem);changeLeft.append(leftItem)}changeLeft.css({width:_opts.showWidth,height:_opts.showHeight});_elem.append(changeLeft).append(changeRight).append(getDiv("clear"));_elem.css({width:_opts.width,height:_opts.height});_elem.find(".changeItem").first().css({marginTop:0})},initEvent:function(){var _this=this;var _elem=this.elem;var _opts=this.opts;_elem.mouseenter(function(){_this.clearTimer()}).mouseleave(function(){_this.startTimer()});var itemList=_elem.find(".changeItem");var leftList=_elem.find(".leftItem");itemList.mouseenter(function(){var thisItem=$(this);var index=itemList.index(thisItem);_elem.attr("data-index",index);_this.showIndex()});_this.showIndex()},showIndex:function(){var _this=this;var _elem=this.elem;var _opts=this.opts;var itemList=_elem.find(".changeItem");var leftList=_elem.find(".leftItem");var index=_this.getIndex();var thisItem=itemList.eq(index);var changeUp=getDiv("changeUp");changeUp.css({width:_opts.hideWidth-(_opts.borderWidth*2),height:_opts.hideHeight-(_opts.borderWidth*2)});var arrowLeft=getDiv("arrowLeft");changeUp.append(arrowLeft);arrowLeft.css({top:(_opts.hideHeight-_opts.borderWidth*2-10)/2});thisItem.append(changeUp);thisItem.siblings().find(".changeUp").remove();thisItem.find(".changeBack").css({opacity:1});thisItem.siblings().find(".changeBack").css({opacity:0.5});var aboveIndex=_this.getAboveIndex();var thisLeft=leftList.eq(index);thisLeft.show().stop(true,false).animate({opacity:1},_opts.changeTime,function(){});thisLeft.siblings().stop().animate({opacity:0},_opts.changeTime,function(){$(this).hide()})},startTimer:function(){var _this=this;var _opts=this.opts;var _elem=this.elem;timer=setInterval(function(){_elem.attr("data-index",_this.getNextIndex());_this.showIndex()},_opts.autoTime)},clearTimer:function(){if(timer!=null){clearInterval(timer)}},getData:function(){return this.opts.data},getCount:function(){return this.getData().length},getIndex:function(){var index=this.elem.attr("data-index");if(isNaN(index)){return 0}return parseInt(index)},getNextIndex:function(){var index=this.getIndex();index++;if(index>=this.getCount()){index=0}return index},getAboveIndex:function(){var index=this.getIndex();index--;if(index<0){index=this.getCount()}return index}};function getDiv(cla){var div=$("<div />");div.addClass(cla);return div}function getImg(src,title){var img=$("<img />");img.attr("src",src).attr("alt",title).attr("title",title);return img}$.fn.changeImg=function(opts){var change=new ChangeImg(this,opts);change.init();return change}})();